(this["webpackJsonpbasic-virtual-tryon-glasses"]=this["webpackJsonpbasic-virtual-tryon-glasses"]||[]).push([[0],{19:function(e,t,n){e.exports=n(35)},24:function(e,t,n){},26:function(e,t,n){},32:function(e,t){},33:function(e,t){},34:function(e,t){},35:function(e,t,n){"use strict";n.r(t);var i,o,a,r,s,c,d,u,l,p,v,f=n(4),m=n.n(f),h=n(16),w=n.n(h),y=(n(24),n(5)),g=n(6),b=n(8),x=n(7),j=n(2),W=n.n(j),E=n(3),O=(n(26),n(1)),k=n(17),G=n(11),z=n(18),M=n(0);function B(e){c=document.getElementById("facemesh-video"),l=document.getElementById("threejsContainer"),(u=new O.w(50,c.videoWidth/c.videoHeight,1,5e3)).position.z=c.videoHeight,u.position.x=-c.videoWidth/2,u.position.y=-c.videoHeight/2,(s=new O.D(c)).minFilter=O.n,v=new O.C(new O.s({map:s,depthWrite:!1,side:O.e})),(p=new O.B).add(v),v.center.set(.5,.5),v.scale.set(-c.videoWidth,c.videoHeight,1),v.position.copy(u.position),v.position.z=0,function(){var e=new O.x(15658734);e.position.set(10,50,20),p.add(e);var t=new O.a(16742399);p.add(t)}(),function(){var e=new O.j;e.vertices.push(new O.G(1,0,0)),e.vertices.push(new O.G(-1,0,0)),e.vertices.push(new O.G(0,0,1)),e.faces.push(new O.f(0,1,2)),(r=new O.r(e,new O.s({side:O.e}))).visible=!1,p.add(r)}(),(new G.a).load("/basic-virtual-tryon-glasses/obj/facemesh.obj",(function(e){e.traverse((function(e){e instanceof O.r&&((a=new O.r(e.geometry,new O.t({side:O.i,color:"blue"}))).material.colorWrite=!1,a.renderOrder=5,p.add(a))}))})),function(e){var t=new k.a;t.setMaterialOptions({side:O.e}),t.load("/basic-virtual-tryon-glasses/obj/"+e+".mtl",(function(t){t.preload();var n=new G.a;n.setMaterials(t),n.load("/basic-virtual-tryon-glasses/obj/"+e+".obj",(function(t){(o=t).name=e,o.renderOrder=3,p.add(o)}))}))}(e),(d=new O.I({antialias:!0,alpha:!0,preserveDrawingBuffer:!0})).setPixelRatio(window.devicePixelRatio),d.setSize(640,640*c.videoHeight/c.videoWidth),l.appendChild(d.domElement),window.addEventListener("resize",C,!1),H()}function C(){u.aspect=c.videoWidth/c.videoHeight,u.updateProjectionMatrix(),d.setSize(640,640*c.videoHeight/c.videoWidth),d.setClearColor(15658734,1)}function H(){s.needsUpdate=!0,requestAnimationFrame(H),d.render(p,u)}function F(){return A.apply(this,arguments)}function A(){return(A=Object(E.a)(W.a.mark((function e(){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.Yb("webgl");case 2:return e.next=4,z.a({maxFaces:1});case 4:i=e.sent,D();case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return I.apply(this,arguments)}function I(){return(I=Object(E.a)(W.a.mark((function e(){var t,n,s,d,l,p,v,f,m,h,w,y,g,b,x,j;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.estimateFaces(c);case 2:if((t=e.sent).length>0)for(a.visible=!0,o.visible=!0,n=0;n<t.length;n++)s=t[n].scaledMesh,d=new O.G(-s[7][0],-s[7][1],-s[7][2]),l=new O.G(-s[175][0],-s[175][1],-s[175][2]),p=new O.G(-s[263][0],-s[263][1],-s[263][2]),r.geometry.vertices[0].copy(l),r.geometry.vertices[1].copy(d),r.geometry.vertices[2].copy(p),r.geometry.verticesNeedUpdate=!0,r.geometry.computeFaceNormals(),v=new O.G(-s[10][0],-s[10][1],-s[10][2]),f=new O.G(-s[175][0],-s[175][1],-s[175][2]),m=v.distanceTo(f)/110.5,h=new O.G(-s[168][0],-s[5][1],-s[10][2]-190),w=new O.G(-s[168][0],-s[1][1],-s[10][2]-160),(y=r.geometry.faces[0].normal.clone()).transformDirection(r.matrixWorld),y.add(w),(g=r.geometry.faces[0].normal.clone()).transformDirection(r.matrixWorld),g.add(h),a.position.set(h.x,h.y,h.z),o.position.set(w.x,w.y,w.z),a.lookAt(g),o.lookAt(y),b=w.x-u.position.x,x=w.y-u.position.y,2.8,960,3.6,960,a.position.x+=b/2.8,o.position.x+=b/2.8,a.rotation.y+=-b/960,o.rotation.y+=-b/960,a.position.y+=x/3.6,o.position.y+=x/3.6,a.rotation.x+=x/960,o.rotation.x+=x/960,o.rotation.x+=.1,Math.abs(o.rotation.y)>.15&&(a.position.z-=40,o.position.z-=40),o.scale.set(m,m,1.35*m),j=1.1*m,a.scale.set(j,j,j),a.updateWorldMatrix(),o.updateWorldMatrix();else o.visible=!1,a.visible=!1;requestAnimationFrame(D);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var N=function(){var e;return Object(f.useEffect)((function(){function t(){return(t=Object(E.a)(W.a.mark((function t(){return W.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=document.getElementById("facemesh-video"),t.next=3,navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user"}}).then((function(t){e.srcObject=t}));case 3:e.oncanplay=function(t){e.play(),B("purple1"),F()};case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){t.apply(this,arguments)}(),function(){}}),[]),m.a.createElement("div",{className:"row arcomp"},m.a.createElement("div",{id:"threejsContainer"},m.a.createElement("video",{id:"facemesh-video"})))},P=function(e){Object(b.a)(n,e);var t=Object(x.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"render",value:function(){return m.a.createElement("div",{className:"App"},m.a.createElement(N,{onReady:this.ready}))}}]),n}(f.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));w.a.render(m.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[19,1,2]]]);
//# sourceMappingURL=main.3aa8d165.chunk.js.map