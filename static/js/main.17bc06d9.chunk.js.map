{"version":3,"sources":["components/render.js","components/FaceFilter.js","components/App.js","serviceWorker.js","index.js"],"names":["model","glassesObj","faceObj","triangle","bg","video","renderer","camera","container","scene","videoSprite","IntializeThreejs","objName","document","getElementById","THREE","videoWidth","videoHeight","position","z","x","y","minFilter","map","depthWrite","side","add","center","set","scale","copy","light","lightAmb","setTheLights","triGeo","vertices","push","faces","visible","setTriangleToScene","OBJLoader","load","process","obj","traverse","child","geometry","color","material","colorWrite","renderOrder","mtlLoader","MTLLoader","setMaterialOptions","materials","preload","objLoader","setMaterials","name","setGlassesToScene","antialias","alpha","preserveDrawingBuffer","setPixelRatio","window","devicePixelRatio","setSize","appendChild","domElement","addEventListener","onWindowResize","animate","aspect","updateProjectionMatrix","setClearColor","needsUpdate","requestAnimationFrame","render","IntializeEngine","a","tf","facemesh","maxFaces","renderPrediction","estimateFaces","predictions","length","i","points","scaledMesh","v2","v1","v3","verticesNeedUpdate","computeFaceNormals","p1","p2","scaleFactor","distanceTo","faceBasePos","basePosition","lkt","normal","clone","transformDirection","matrixWorld","lktFace","lookAt","diffPosX","diffPosY","windowWidth","windowHeight","rotation","Math","abs","faceScale","updateWorldMatrix","FaceFilter","useEffect","navigator","mediaDevices","getUserMedia","facingMode","then","stream","srcObject","oncanplay","e","play","init","className","id","App","onReady","this","ready","Component","Boolean","location","hostname","match","ReactDOM","serviceWorker","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.17bc06d9.chunk.js","sourcesContent":["import * as THREE from 'three';\r\nimport {MTLLoader} from 'three/examples/jsm/loaders/MTLLoader';\r\nimport {OBJLoader} from 'three/examples/jsm/loaders/OBJLoader';\r\nimport * as facemesh from '@tensorflow-models/facemesh';\r\nimport * as tf from '@tensorflow/tfjs-core';\r\n\r\n\r\nvar model;\r\nvar glassesObj;\r\nvar faceObj;\r\nvar triangle;\r\nvar bg;\r\nvar video;\r\nlet renderer;\r\nlet camera;\r\nvar container;\r\nlet scene;\r\nlet videoSprite;\r\nlet windowWidth = 640;\r\nlet windowHeight = 480;\r\n\r\nfunction setVideoContent(){\r\n    camera = new THREE.PerspectiveCamera(50, video.videoWidth / video.videoHeight, 1, 5000);\r\n\r\n    camera.position.z = video.videoHeight;\r\n    camera.position.x = -video.videoWidth / 2;\r\n    camera.position.y = -video.videoHeight / 2;\r\n\r\n    bg = new THREE.Texture(video);\r\n\r\n    bg.minFilter = THREE.LinearFilter;\r\n\r\n    videoSprite = new THREE.Sprite(new THREE.MeshBasicMaterial({\r\n        map: bg,\r\n        depthWrite: false,\r\n        side: THREE.DoubleSide\r\n    }));\r\n    scene = new THREE.Scene();\r\n\r\n    scene.add(videoSprite);\r\n    videoSprite.center.set(0.5, 0.5);\r\n    videoSprite.scale.set(-video.videoWidth, video.videoHeight, 1);\r\n    videoSprite.position.copy(camera.position);\r\n    videoSprite.position.z = 0;\r\n}\r\n\r\nfunction setTriangleToScene(){\r\n    const triGeo = new THREE.Geometry();\r\n    triGeo.vertices.push(new THREE.Vector3(1, 0, 0));\r\n    triGeo.vertices.push(new THREE.Vector3(-1, 0, 0));\r\n    triGeo.vertices.push(new THREE.Vector3(0, 0, 1));\r\n\r\n    triGeo.faces.push(new THREE.Face3(0, 1, 2));\r\n\r\n    triangle = new THREE.Mesh(triGeo, new THREE.MeshBasicMaterial({ side: THREE.DoubleSide }));\r\n    triangle.visible = false;\r\n    scene.add(triangle);\r\n}\r\n\r\nfunction setTheLights(){\r\n    var light = new THREE.PointLight(0xeeeeee);\r\n    light.position.set(10, 50, 20);\r\n    scene.add(light);\r\n     \r\n    var lightAmb = new THREE.AmbientLight(0xff77ff);\r\n    scene.add(lightAmb);\r\n}\r\n\r\nfunction setGlassesToScene(objName){\r\n\r\n    var mtlLoader = new MTLLoader();\r\n    mtlLoader.setMaterialOptions({side:THREE.DoubleSide});\r\n    mtlLoader.load(process.env.PUBLIC_URL+\"/\"+objName+'.mtl', materials => {\r\n        materials.preload();\r\n        const objLoader = new OBJLoader();\r\n        objLoader.setMaterials(materials);\r\n        objLoader.load(process.env.PUBLIC_URL+\"/\"+objName+'.obj', obj => {\r\n            glassesObj = obj;\r\n            glassesObj.name = objName;\r\n            glassesObj.renderOrder = 3;\r\n            scene.add(glassesObj);\r\n        })\r\n    })\r\n}\r\n\r\nfunction getFaceMask(){\r\n    new OBJLoader().load(process.env.PUBLIC_URL+'/facemesh.obj', obj => {\r\n        obj.traverse(child => {\r\n            if (child instanceof THREE.Mesh) {\r\n                faceObj = new THREE.Mesh(child.geometry, new THREE.MeshLambertMaterial({side: THREE.FrontSide, color: \"blue\"}));\r\n                faceObj.material.colorWrite = false;\r\n                faceObj.renderOrder = 5;\r\n                scene.add(faceObj);\r\n            }\r\n        });\r\n    })\r\n}\r\n\r\nexport function IntializeThreejs(objName) {\r\n    video = document.getElementById('facemesh-video');\r\n\r\n    container = document.getElementById('threejsContainer');\r\n    setVideoContent();\r\n\r\n    setTheLights();\r\n\r\n    setTriangleToScene();\r\n\r\n    getFaceMask();\r\n    \r\n    setGlassesToScene(objName);\r\n\r\n    renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true, preserveDrawingBuffer: true });\r\n    renderer.setPixelRatio(window.devicePixelRatio);\r\n    renderer.setSize(windowWidth, windowWidth * video.videoHeight / video.videoWidth);\r\n    \r\n    container.appendChild(renderer.domElement);\r\n    window.addEventListener('resize', onWindowResize, false);\r\n    animate();\r\n}\r\n\r\nfunction onWindowResize() {\r\n    camera.aspect = video.videoWidth / video.videoHeight;\r\n    camera.updateProjectionMatrix();\r\n\r\n    renderer.setSize(windowWidth, windowWidth * video.videoHeight / video.videoWidth);\r\n    renderer.setClearColor( 0xeeeeee, 1 );\r\n}\r\n\r\nfunction animate() {\r\n    bg.needsUpdate = true;\r\n    requestAnimationFrame(animate);\r\n    renderer.render(scene, camera);\r\n}\r\n\r\nexport async function IntializeEngine() {\r\n    await tf.setBackend('webgl');\r\n    model = await facemesh.load({ maxFaces: 1 });\r\n    renderPrediction();\r\n}\r\n\r\nasync function renderPrediction() {\r\n    \r\n    const predictions = await model.estimateFaces(video);\r\n\r\n    if (predictions.length > 0) {\r\n\r\n        faceObj.visible = true;\r\n        glassesObj.visible = true;\r\n        for (let i = 0; i < predictions.length; i++) {\r\n            const points = predictions[i].scaledMesh;\r\n\r\n            const v2 = new THREE.Vector3(-points[7][0], -points[7][1], -points[7][2]);\r\n            const v1 = new THREE.Vector3(-points[175][0], -points[175][1], -points[175][2])\r\n            const v3 = new THREE.Vector3(-points[263][0], -points[263][1], -points[263][2])\r\n\r\n            triangle.geometry.vertices[0].copy(v1);\r\n            triangle.geometry.vertices[1].copy(v2);\r\n            triangle.geometry.vertices[2].copy(v3);\r\n            triangle.geometry.verticesNeedUpdate = true;\r\n            triangle.geometry.computeFaceNormals();\r\n\r\n            const p1 = new THREE.Vector3(-points[10][0], -points[10][1], -points[10][2]);\r\n            const p2 = new THREE.Vector3(-points[175][0], -points[175][1], -points[175][2]);\r\n            const scaleFactor = p1.distanceTo(p2) / 110.5;\r\n\r\n            const faceBasePos = new THREE.Vector3(-points[168][0], -points[5][1], -points[10][2]-190);\r\n            const basePosition = new THREE.Vector3(-points[168][0], -points[1][1], -points[10][2]-160);\r\n            const lkt = triangle.geometry.faces[0].normal.clone();\r\n            lkt.transformDirection(triangle.matrixWorld);\r\n            lkt.add(basePosition);\r\n\r\n            const lktFace = triangle.geometry.faces[0].normal.clone();\r\n            lktFace.transformDirection(triangle.matrixWorld);\r\n            lktFace.add(faceBasePos);\r\n\r\n            faceObj.position.set(faceBasePos.x, faceBasePos.y, faceBasePos.z);\r\n            glassesObj.position.set(basePosition.x, basePosition.y, basePosition.z);\r\n            faceObj.lookAt(lktFace);\r\n            glassesObj.lookAt(lkt);\r\n            \r\n            const diffPosX = basePosition.x - camera.position.x;\r\n            const diffPosY = basePosition.y - camera.position.y;\r\n            const posFactor = windowWidth*3.5 / 800;\r\n            const rotFactor = windowWidth * 1.50;\r\n            const posFactorY = windowHeight*4.5 / 600;\r\n            const rotFactorY = windowHeight*1200 / 600;\r\n\r\n            faceObj.position.x += diffPosX / posFactor;\r\n            glassesObj.position.x += diffPosX / posFactor;\r\n            faceObj.rotation.y += -diffPosX/ rotFactor;\r\n            glassesObj.rotation.y += -diffPosX/ rotFactor;\r\n\r\n            faceObj.position.y += diffPosY / posFactorY;\r\n            glassesObj.position.y += diffPosY / posFactorY;\r\n            faceObj.rotation.x += diffPosY/ rotFactorY;\r\n            glassesObj.rotation.x += diffPosY/ rotFactorY;\r\n\r\n            glassesObj.rotation.x += 0.10;\r\n\r\n            if(Math.abs(glassesObj.rotation.y) > 0.15){\r\n                faceObj.position.z -= 40;\r\n                glassesObj.position.z -= 40;\r\n            }\r\n\r\n            glassesObj.scale.set(scaleFactor,scaleFactor,scaleFactor*1.35);\r\n            const faceScale = scaleFactor * 1.10;\r\n            faceObj.scale.set(faceScale,faceScale,faceScale);\r\n\r\n            faceObj.updateWorldMatrix();\r\n            glassesObj.updateWorldMatrix();\r\n\r\n        }\r\n    }\r\n    else {\r\n        glassesObj.visible = false;\r\n        faceObj.visible = false;\r\n    }\r\n    requestAnimationFrame(renderPrediction);\r\n}\r\n","import React from 'react';\r\nimport { useEffect } from 'react';\r\nimport '../style/FaceFilter.style.css';\r\n\r\nimport {\r\n    IntializeEngine, IntializeThreejs\r\n} from './render.js';\r\n\r\n\r\nexport const FaceFilter = () => {\r\n\r\n    var video;\r\n\r\n    useEffect(() => {\r\n\r\n        async function init() {\r\n            video = document.getElementById('facemesh-video');\r\n\r\n            await navigator.mediaDevices.getUserMedia({\r\n                'audio': false,\r\n                'video': {\r\n                    facingMode: 'user',\r\n                }\r\n            }).then(stream => {\r\n                video.srcObject = stream;\r\n            });\r\n\r\n            video.oncanplay = (e) => {\r\n                video.play();\r\n                IntializeThreejs(\"purple1\");\r\n                IntializeEngine();\r\n            }\r\n        }\r\n\r\n        init();\r\n\r\n        return () => {\r\n\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <div className=\"row arcomp\">\r\n            <div id=\"threejsContainer\">\r\n                <video id=\"facemesh-video\"></video>\r\n            </div>\r\n        </div>\r\n\r\n    )\r\n}","import React, { Component } from 'react';\r\nimport { FaceFilter } from './FaceFilter'\r\n\r\nexport default class App extends Component {\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"App\">\r\n        <FaceFilter  onReady={this.ready}/>\r\n      </div>\r\n\r\n    );\r\n  }\r\n  \r\n}\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './style/index.style.css';\r\nimport App from './components/App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}